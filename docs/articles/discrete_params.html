<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SBC with discrete parameters • SBC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SBC with discrete parameters">
<meta property="og:description" content="SBC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SBC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bad_parametrization.html">Discovering bad parametrization with SBC</a>
    </li>
    <li>
      <a href="../articles/basic_usage.html">SBC Interface Introduction</a>
    </li>
    <li>
      <a href="../articles/brms.html">SBC for brms models</a>
    </li>
    <li>
      <a href="../articles/discrete_params.html">SBC with discrete parameters</a>
    </li>
    <li>
      <a href="../articles/indexing.html">Discovering indexing errors with SBC</a>
    </li>
    <li>
      <a href="../articles/limits_of_SBC.html">Limits of SBC</a>
    </li>
    <li>
      <a href="../articles/rejection_sampling.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/small_model_workflow.html">Small model workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="discrete_params_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SBC with discrete parameters</h1>
            
      
      
      <div class="hidden name"><code>discrete_params.Rmd</code></div>

    </div>

    
    
<p>Model from: <a href="https://mc-stan.org/docs/2_26/stan-users-guide/change-point-section.html" class="external-link uri">https://mc-stan.org/docs/2_26/stan-users-guide/change-point-section.html</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stan_code_1</span> <span class="op">&lt;-</span> <span class="st">"
data {
  real&lt;lower=0&gt; r_e;
  real&lt;lower=0&gt; r_l;

  int&lt;lower=1&gt; T;
  int&lt;lower=0&gt; y[T];
}
transformed data {
  real log_unif;
  log_unif = -log(T);
}
parameters {
  real&lt;lower=0&gt; e;
  real&lt;lower=0&gt; l;
}
transformed parameters {
  vector[T] lp;
  lp = rep_vector(log_unif, T);
  for (s in 1:T)
    for (t in 1:T)
      lp[s] = lp[s] + poisson_lpmf(y[t] | t &lt; s ? e : l);
}
model {
  e ~ exponential(r_e);
  l ~ exponential(r_l);
  target += log_sum_exp(lp);
}

generated quantities {
  int&lt;lower=1,upper=T&gt; s;
  s = categorical_logit_rng(lp);
}
"</span>

<span class="kw">if</span><span class="op">(</span><span class="va">use_cmdstanr</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html" class="external-link">cmdstan_model</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/write_stan_file.html" class="external-link">write_stan_file</a></span><span class="op">(</span><span class="va">stan_code_1</span><span class="op">)</span><span class="op">)</span>
  <span class="va">backend_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SBC_backend_cmdstan_sample.html">SBC_backend_cmdstan_sample</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stan_model.html" class="external-link">stan_model</a></span><span class="op">(</span>model_code <span class="op">=</span> <span class="va">stan_code_1</span><span class="op">)</span>
  <span class="va">backend_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SBC_backend_rstan_sample.html">SBC_backend_rstan_sample</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">generate_single_dataset_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">T</span>, <span class="va">r_e</span>, <span class="va">r_l</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">r_e</span><span class="op">)</span>
  <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">r_l</span><span class="op">)</span>
  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="cn">T</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">T</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">s</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">e</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">l</span>
    <span class="op">}</span>
    <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">rate</span><span class="op">)</span> 
  <span class="op">}</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      e <span class="op">=</span> <span class="va">e</span>, l <span class="op">=</span> <span class="va">l</span>, s <span class="op">=</span> <span class="va">s</span>
    <span class="op">)</span>, generated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      T <span class="op">=</span> <span class="cn">T</span>,
      r_e <span class="op">=</span> <span class="va">r_e</span>,
      r_l <span class="op">=</span> <span class="va">r_l</span>,
      y <span class="op">=</span> <span class="va">y</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">generator_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SBC_generator_function.html">SBC_generator_function</a></span><span class="op">(</span><span class="va">generate_single_dataset_1</span>, T <span class="op">=</span> <span class="fl">5</span>, r_e <span class="op">=</span> <span class="fl">0.5</span>, r_l <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">85394672</span><span class="op">)</span>
<span class="va">datasets_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_datasets.html">generate_datasets</a></span><span class="op">(</span><span class="va">generator_1</span>, <span class="fl">30</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_results.html">compute_results</a></span><span class="op">(</span><span class="va">datasets_1</span>, <span class="va">backend_1</span><span class="op">)</span></code></pre></div>
<pre><code>##  - 5 (17%) fits had at least one Rhat &gt; 1.01. Largest Rhat was NA.</code></pre>
<pre><code>##  - 22 (73%) fits had tail ESS undefined or less than half of the maximum rank, potentially skewing the rank statistics. The lowest tail ESS was NA.
##  If the fits look good otherwise, increasing `thin_ranks` (via recompute_statistcs) or number of posterior samples (by refitting) might help.</code></pre>
<pre><code>## Not all diagnostics are OK. You can learn more by inspecting $default_diagnostics, $backend_diagnostics and/or investigating $outputs/$messages/$warnings for detailed output from the backend.</code></pre>
<p>TODO the diagnostics are false positives, because Rhat and ESS don’t work very well for discrete parameters. We need to figure out how to handle this better.</p>
<p>We can quickly note that the statistics for the <code>s</code> parameter are extreme - many ranks of 0 and <em>extreme</em> z-scores, including -Infinity. Seing just one or two such fits should be enough to convince us that there is something fundamentally wrong.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">results_1</span><span class="op">$</span><span class="va">stats</span>, <span class="va">parameter</span> <span class="op">==</span> <span class="st">"s"</span><span class="op">)</span> </code></pre></div>
<pre><code>## # A tibble: 30 × 15
##    parameter simulated_value  rank   z_score  mean median    sd   mad    q5
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 s                       3   219    0.0285  2.95      3 1.61   2.97     1
##  2 s                       1    11   -2.04    2.01      2 0.495  0        1
##  3 s                       4    25   -1.33    4.65      5 0.491  0        4
##  4 s                       1    20   -3.25    2.88      3 0.578  0        2
##  5 s                       5   387    2.80    2.85      3 0.767  0        1
##  6 s                       2   243    0.0412  1.94      1 1.41   0        1
##  7 s                       3     0 -Inf       4         4 0      0        4
##  8 s                       2   131   -0.597   2.87      3 1.45   1.48     1
##  9 s                       2     3   -8.55    2.99      3 0.116  0        3
## 10 s                       2     1   -8.06    3.00      3 0.123  0        3
## # … with 20 more rows, and 6 more variables: q95 &lt;dbl&gt;, rhat &lt;dbl&gt;,
## #   ess_bulk &lt;dbl&gt;, ess_tail &lt;dbl&gt;, max_rank &lt;int&gt;, dataset_id &lt;int&gt;</code></pre>
<p>Inspecting the statistics shows that quite often, the model is quite sure of the value of <code>s</code> while the simulated value is just one less.</p>
<p>Looking at the ecdf_diff plot we see that this seems to compromise heavily the inference for <code>s</code>, but the other parmaters do not show such bad behaviour.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ECDF-plots.html">plot_ecdf_diff</a></span><span class="op">(</span><span class="va">results_1</span><span class="op">)</span></code></pre></div>
<p><img src="discrete_params_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>So what happened? After some inspection, you may notice that the simulator does not match the model - the model takes the early rate (<code>e</code>) for points <code>t &lt; s</code> while the simulator takes <code>e</code> for points <code>t &lt;=  s</code>, so there is effectively a shift by one time point between the simulator and the model. So let’s assume that we beleive that the Stan model is in fact right. We therfore updated the simulator to match the model:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">generate_single_dataset_2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">T</span>, <span class="va">r_e</span>, <span class="va">r_l</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">r_e</span><span class="op">)</span>
  <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">r_l</span><span class="op">)</span>
  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="cn">T</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">T</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">s</span><span class="op">)</span> <span class="op">{</span> <span class="co">### &lt;--- Only change here</span>
      <span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">e</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="va">rate</span> <span class="op">&lt;-</span> <span class="va">l</span>
    <span class="op">}</span>
    <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">rate</span><span class="op">)</span> 
  <span class="op">}</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      e <span class="op">=</span> <span class="va">e</span>, l <span class="op">=</span> <span class="va">l</span>, s <span class="op">=</span> <span class="va">s</span>
    <span class="op">)</span>, generated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      T <span class="op">=</span> <span class="cn">T</span>,
      r_e <span class="op">=</span> <span class="va">r_e</span>,
      r_l <span class="op">=</span> <span class="va">r_l</span>,
      y <span class="op">=</span> <span class="va">y</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">generator_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SBC_generator_function.html">SBC_generator_function</a></span><span class="op">(</span><span class="va">generate_single_dataset_2</span>, T <span class="op">=</span> <span class="fl">5</span>, r_e <span class="op">=</span> <span class="fl">0.5</span>, r_l <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5846502</span><span class="op">)</span>
<span class="va">datasets_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_datasets.html">generate_datasets</a></span><span class="op">(</span><span class="va">generator_2</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">results_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_results.html">compute_results</a></span><span class="op">(</span><span class="va">datasets_2</span>, <span class="va">backend_1</span><span class="op">)</span></code></pre></div>
<pre><code>##  - 12 (40%) fits had at least one Rhat &gt; 1.01. Largest Rhat was NA.</code></pre>
<pre><code>##  - 27 (90%) fits had tail ESS undefined or less than half of the maximum rank, potentially skewing the rank statistics. The lowest tail ESS was NA.
##  If the fits look good otherwise, increasing `thin_ranks` (via recompute_statistcs) or number of posterior samples (by refitting) might help.</code></pre>
<pre><code>##  - 4 (13%) fits had divergent transitions. Maximum number of divergences was 13.</code></pre>
<pre><code>## Not all diagnostics are OK. You can learn more by inspecting $default_diagnostics, $backend_diagnostics and/or investigating $outputs/$messages/$warnings for detailed output from the backend.</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ECDF-plots.html">plot_ecdf_diff</a></span><span class="op">(</span><span class="va">results_2</span><span class="op">)</span></code></pre></div>
<p><img src="discrete_params_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Looks good, so let us add some more SBC steps to make sure the model behaves well.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">54321488</span><span class="op">)</span>
<span class="va">datasets_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_datasets.html">generate_datasets</a></span><span class="op">(</span><span class="va">generator_2</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">results_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_results.html">compute_results</a></span><span class="op">(</span><span class="va">datasets_3</span>, <span class="va">backend_1</span><span class="op">)</span></code></pre></div>
<pre><code>##  - 22 (22%) fits had at least one Rhat &gt; 1.01. Largest Rhat was NA.</code></pre>
<pre><code>##  - 83 (83%) fits had tail ESS undefined or less than half of the maximum rank, potentially skewing the rank statistics. The lowest tail ESS was NA.
##  If the fits look good otherwise, increasing `thin_ranks` (via recompute_statistcs) or number of posterior samples (by refitting) might help.</code></pre>
<pre><code>##  - 8 (8%) fits had divergent transitions. Maximum number of divergences was 21.</code></pre>
<pre><code>## Not all diagnostics are OK. You can learn more by inspecting $default_diagnostics, $backend_diagnostics and/or investigating $outputs/$messages/$warnings for detailed output from the backend.</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_results.html">bind_results</a></span><span class="op">(</span><span class="va">results_2</span>, <span class="va">results_3</span><span class="op">)</span>
<span class="fu"><a href="../reference/ECDF-plots.html">plot_ecdf_diff</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">)</span></code></pre></div>
<p><img src="discrete_params_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Now - as far as this amount of SBC steps can see, the model is good and we get good behaviour for both the continuous and the discrete parameters.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shinyoung Kim, Hyunji Moon, Martin Modrák.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
